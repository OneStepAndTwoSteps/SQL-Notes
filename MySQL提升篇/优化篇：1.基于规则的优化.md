# MySQL 基于规则的优化

一些比较重要的重写规则。


## 条件化简

### 常量传递（constant_propagation）

#### AND :

*   有时候某个表达式是某个列和某个常量做等值匹配：

        a = 5

*   当这个表达式和其他涉及列a的表达式使用AND连接起来时，可以将其他表达式中的a的值替换为5，比如这样：

        a = 5 AND b > a

*   就可以被转换为：

        a = 5 AND b > 5

但是注意：使用 or 就不能进行这样的转换：

#### OR :

*   如当有一条数据为 a = 0, b = 1 :

        a = 5 OR b > a  ≠ a = 5 OR b > 5

#### 不能转化的原因：

*   因为 OR 为并集，只要其中一个条件满足即可，而 AND 取交集，所以当有数据为 a = 0,b = 1 时：

        a = 5 OR b > a     # 为 a = 5  条件满足 或者 b > a 条件满足

        a = 5 OR b > 5     # 为 a = 5, 条件满足 或者 b > 5 条件满足，而 a 不一定要等于5

        a = 5 AND b > a    # AND 需要两个条件都满足，所以 a 必须要满足等于 5 这个条件
        
        a = 5 AND b > 5    # 所以使用 AND 可以转化成常数



